---
interface Props { steps: string[]; center?: string }
const { steps, center = '循環設計' } = Astro.props as Props;
const radius = 120;
---
<div class="cycle-wrap">
  <div class="cycle" style={`--r:${radius}px`} aria-hidden="true">
    <div class="ring"></div>
    <div class="center">
      <strong>{center}</strong>
      <div class="muted" style="font-size:12px">IEO → 拠点 → 計測 → 記録 → NFT → 再投資</div>
    </div>
    {steps.map((_, i) => {
      const ang = (360/steps.length) * i - 90;
      return (
        <div class="node" style={`--ang:${ang}deg`}>
          <div class="badge">{i+1}</div>
        </div>
      );
    })}
    {steps.map((_, i) => {
      const ang = (360/steps.length) * i - 90;
      return (<div class="arrow" style={`--ang:${ang}deg`}></div>);
    })}
  </div>

  <ol class="cycle-list">
    {steps.map((s, i) => (
      <li>
        <span class="n">{i+1}</span>
        <span class="t">{s}</span>
      </li>
    ))}
  </ol>
</div>

<style is:global>
.cycle-wrap{ display:grid; grid-template-columns: 1fr; gap:18px }
@media (min-width: 900px){ .cycle-wrap{ grid-template-columns: 360px 1fr; align-items:center } }

.cycle{ position:relative; width:min(360px, 90vw); aspect-ratio:1/1; margin:auto }
.cycle .ring{ position:absolute; inset:10%; border-radius:50%; background: radial-gradient(closest-side, #0c261f 60%, transparent 61%), conic-gradient(from 0deg, #1dfaa033, #00e0ff33, #1dfaa033); border:1px solid var(--outline); filter: drop-shadow(0 10px 30px #0008) }
.cycle .center{ position:absolute; inset:38% 28%; display:grid; place-items:center; text-align:center; padding:10px; border-radius:16px; background:#0f2a22cc; border:1px solid #184c3d; box-shadow: var(--shadow) }
.cycle .node{ position:absolute; left:50%; top:50%; transform: rotate(var(--ang)) translate(var(--r)) rotate(calc(var(--ang) * -1)); width: 0 }
.cycle .badge{ width:28px; height:28px; border-radius:999px; background: linear-gradient(180deg, var(--accent), var(--accent-2)); color:#042315; display:grid; place-items:center; font-weight:800; box-shadow: 0 4px 16px #00ffab44; font-size:12px }
.cycle .arrow{ position:absolute; left:50%; top:50%; width: calc(var(--r) - 28px); height:2px; background: linear-gradient(90deg, #00ffc2, transparent); transform-origin:left center; transform: rotate(var(--ang)) translateX(28px); opacity:.45 }
.cycle .arrow::after{ content:""; position:absolute; right:-6px; top:-3px; border:6px solid transparent; border-left-color:#00ffc2; opacity:.8 }

.cycle-list{ margin:0; padding:0; }
.cycle-list li{ list-style:none; display:flex; gap:10px; align-items:flex-start; padding:10px 0; border-bottom:1px solid var(--outline) }
.cycle-list .n{ display:inline-grid; place-items:center; min-width:26px; height:26px; border-radius:999px; background: linear-gradient(180deg, var(--accent), var(--accent-2)); color:#042315; font-weight:800; font-size:12px }
.cycle-list .t{ flex:1; line-height:1.5 }

@media (max-width: 899px){
  .cycle{ display:none }
}
</style>
